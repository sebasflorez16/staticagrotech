<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Recursos Humanos</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/css/icons.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/css/app.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/css/employees.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <div id="left-sidebar"></div>
    <div id="topbar-container"></div>

    <div id="main-content" class="container mt-5" style="margin-top: 90px;">
        <!-- Título principal del dashboard -->
        <h1 class="mb-4">Dashboard - Recursos Humanos</h1>
    
        <!-- Cards para Empleados, Departamentos y Posiciones -->
        <div class="row">
            <!-- Card para Empleados -->
            <div class="col-md-4">
                <div class="card overflow-hidden">
                    <div class="card-body">
                        <div class="row d-flex justify-content-center">
                            <div class="col">
                                <div class="media">
                                    <div
                                        class="bg-light-alt d-flex justify-content-center align-items-center thumb-md rounded-circle">
                                        <i data-feather="users" class="align-self-center text-muted icon-sm"></i>
                                    </div>
                                    <div class="media-body align-self-center ms-2">
                                        <p class="text-dark mb-1 fw-semibold">Empleados</p>
                                        <p class="mb-0 text-truncate text-muted">Registros de Recursos Humanos</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto align-self-center">
                                <h4 class="my-1" id="employeeCount">Cargando...</h4>
                            </div>
                        </div>
                        <button class="btn btn-primary w-100 mt-3" onclick="mostrarSeccion('empleados')">Ver Lista</button>
                    </div>
                </div>
            </div>
    
            <!-- Card para Departamentos -->
            <div class="col-md-4">
                <div class="card overflow-hidden">
                    <div class="card-body">
                        <div class="row d-flex justify-content-center">
                            <div class="col">
                                <div class="media">
                                    <div
                                        class="bg-light-alt d-flex justify-content-center align-items-center thumb-md rounded-circle">
                                        <i data-feather="briefcase" class="align-self-center text-muted icon-sm"></i>
                                    </div>
                                    <div class="media-body align-self-center ms-2">
                                        <p class="text-dark mb-1 fw-semibold">Departamentos</p>
                                        <p class="mb-0 text-truncate text-muted">Lista de departamentos</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto align-self-center">
                                <h4 class="my-1" id="departmentCount">Cargando...</h4>
                            </div>
                        </div>
                        <button class="btn btn-secondary w-100 mt-3" onclick="mostrarSeccion('departamentos')">Ver Lista</button>
                    </div>
                </div>
            </div>
    
            <!-- Card para Posiciones -->
            <div class="col-md-4">
                <div class="card overflow-hidden">
                    <div class="card-body">
                        <div class="row d-flex justify-content-center">
                            <div class="col">
                                <div class="media">
                                    <div
                                        class="bg-light-alt d-flex justify-content-center align-items-center thumb-md rounded-circle">
                                        <i data-feather="tag" class="align-self-center text-muted icon-sm"></i>
                                    </div>
                                    <div class="media-body align-self-center ms-2">
                                        <p class="text-dark mb-1 fw-semibold">Posiciones</p>
                                        <p class="mb-0 text-truncate text-muted">Lista de posiciones</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-auto align-self-center">
                                <h4 class="my-1" id="positionCount">Cargando...</h4>
                            </div>
                        </div>
                        <button class="btn btn-info w-100 mt-3" onclick="mostrarSeccion('posiciones')">Ver Lista</button>
                    </div>
                </div>
            </div>
        </div>
    
        <!-- Sección de Empleados -->
        <div id="seccion-empleados" class="d-none mt-5">
            <h2>Lista de Empleados</h2>
            <div class="mb-3">
                <button class="btn btn-success" onclick="window.location.href='/templates/employees/employee-create.html'">
                    Crear Nuevo Usuario
                </button>
            </div>
            <table class="table table-striped table-hover">
                <thead id="tabla-empleados-head">
                    <!-- Las columnas se generarán dinámicamente -->
                </thead>
                <tbody id="tabla-empleados-body">
                    <!-- Los datos se cargarán dinámicamente -->
                </tbody>
            </table>
        </div>
    
        <!-- Sección de Departamentos -->
        <div id="seccion-departamentos" class="d-none mt-5">
            <h2>Lista de Departamentos</h2>
            <div class="mb-3">
                <label for="nombre-departamentos" class="form-label">Nombre del Departamento</label>
                <input type="text" id="nombre-departamentos" class="form-control" placeholder="Nuevo Departamento" onfocus="mostrarDescripcion('departamentos')">
            </div>
            <div class="mb-3 d-none" id="descripcion-departamentos-container">
                <label for="descripcion-departamentos" class="form-label">Descripción del Departamento</label>
                <textarea id="descripcion-departamentos" class="form-control" placeholder="Descripción del Departamento"></textarea>
            </div>
            <button class="btn btn-success mt-2" onclick="crearRegistro('departamentos')">Crear Departamento</button>
            <table class="table table-striped table-hover">
                <thead id="tabla-departamentos-head">
                    <!-- Las columnas se generarán dinámicamente -->
                </thead>
                <tbody id="tabla-departamentos-body">
                    <!-- Los datos se cargarán dinámicamente -->
                </tbody>
            </table>
        </div>
    
        <!-- Sección de Posiciones -->
        <div id="seccion-posiciones" class="d-none mt-5">
            <h2>Lista de Posiciones</h2>
            <div class="mb-3">
                <label for="nombre-posiciones" class="form-label">Nombre de la Posición</label>
                <input type="text" id="nombre-posiciones" class="form-control" placeholder="Nueva Posición" onfocus="mostrarDescripcion('posiciones')">
            </div>
            <div class="mb-3 d-none" id="descripcion-posiciones-container">
                <label for="descripcion-posiciones" class="form-label">Descripción de la Posición</label>
                <textarea id="descripcion-posiciones" class="form-control" placeholder="Descripción de la Posición"></textarea>
            </div>
            <button class="btn btn-success mt-2" onclick="crearRegistro('posiciones')">Crear Posición</button>
            <table class="table table-striped table-hover">
                <thead id="tabla-posiciones-head">
                    <!-- Las columnas se generarán dinámicamente -->
                </thead>
                <tbody id="tabla-posiciones-body">
                    <!-- Los datos se cargarán dinámicamente -->
                </tbody>
            </table>
        </div>
        <!-- Sección de Métodos de Pago -->
    <!-- Sección de Métodos de Pago -->
    <div id="seccion-metodos-pago" class="container mt-4">
        <div class="card shadow-lg p-4 border-0 rounded-4 bg-light">
            <h2 class="text-center mb-4 fw-bold" style="color: #2C3E50;">
            Métodos de Pago
            </h2>

            <!-- Botón para crear un nuevo método de pago -->
            <div class="d-flex justify-content-end mb-3">
                <button class="btn text-white d-flex align-items-center gap-2 px-4 py-2 shadow"
                    style="background-color: #F39C12; border-radius: 12px;"
                    onclick="mostrarModalCrearMetodoPago()">
                    <i class="bi bi-plus-lg"></i> Crear Método de Pago
                </button>
            </div>

            <!-- Tabla de Métodos de Pago -->
            <div class="table-responsive">
                <table class="table table-bordered table-hover align-middle text-center" style="border-radius: 10px; overflow: hidden;">
                    <thead id="tabla-metodos-pago-head" style="background-color:rgb(46, 125, 205); color: white;">
                        <tr>
                            <th>ID</th>
                            <th>Nombre</th>
                            <th>Monto</th>
                            <th>Descripción</th>
                            <th>Fecha Creación</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="tabla-metodos-pago-body">
                        <!-- Los datos se cargarán dinámicamente -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!-- Modal para crear un nuevo método de pago -->
    <div class="modal fade" id="modalCrearMetodoPago" tabindex="-1" aria-labelledby="modalCrearMetodoPagoLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalCrearMetodoPagoLabel">Crear Nuevo Método de Pago</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formCrearMetodoPago">
                        <div class="mb-3">
                            <label for="crear-nombre-metodo" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="crear-nombre-metodo" required>
                        </div>
                        <div class="mb-3">
                            <label for="crear-monto-metodo" class="form-label">Monto</label>
                            <input type="number" class="form-control" id="crear-monto-metodo" required>
                        </div>
                        <div class="mb-3">
                            <label for="crear-descripcion-metodo" class="form-label">Descripción</label>
                            <textarea class="form-control" id="crear-descripcion-metodo" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="guardarNuevoMetodoPago()">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para editar un nuevo método de pago -->  
    <div class="modal fade" id="modalEditarMetodoPago" tabindex="-1" aria-labelledby="modalEditarMetodoPagoLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalEditarMetodoPagoLabel">Editar Método de Pago</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formEditarMetodoPago">
                        <input type="hidden" id="editar-id-metodo">
                        <div class="mb-3">
                            <label for="editar-nombre-metodo" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="editar-nombre-metodo" required>
                        </div>
                        <div class="mb-3">
                            <label for="editar-monto-metodo" class="form-label">Monto</label>
                            <input type="number" class="form-control" id="editar-monto-metodo" required>
                        </div>
                        <div class="mb-3">
                            <label for="editar-descripcion-metodo" class="form-label">Descripción</label>
                            <textarea class="form-control" id="editar-descripcion-metodo" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="guardarCambiosMetodoPago()">Guardar Cambios</button>
                </div>
            </div>
        </div>
    </div>
    


    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script> 

    <script>
        // Este script se ejecuta cuando el DOM está completamente cargado para no tener esto repetido en los archivos
        //asi no aseguramos de que el DOM esté listo antes de ejecutar cualquier código y no se interrumpa uno con el otro
        document.addEventListener("DOMContentLoaded", async function () {
            try {
                // Cargar empleados, departamentos y posiciones
                await cargarDatos("empleados");
                await cargarDatos("departamentos");
                await cargarDatos("posiciones");
    
                // Cargar métodos de pago
                await cargarMetodosPago();
            } catch (error) {
                console.error("Error al cargar los datos del dashboard:", error);
            }
        });
    </script>
    <script>
        /**
         * Función para mostrar una sección específica del dashboard
         * @param {string} seccion - El nombre de la sección a mostrar (empleados, departamentos, posiciones)
         */
        function mostrarSeccion(seccion) {
            const secciones = ["empleados", "departamentos", "posiciones"];
            secciones.forEach(s => {
                const elemento = document.getElementById(`seccion-${s}`);
                if (s === seccion) {
                    elemento.classList.remove("d-none"); // Mostrar la sección seleccionada
                } else {
                    elemento.classList.add("d-none"); // Ocultar las demás secciones
                }
            });
        }
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script type="module">
        import { loadLayoutComponents } from '/static/js/load_components.js';
        const components = {
            "topbar-container": "/templates/partials/horizontal-nav.html",
            "footer-container": "/templates/partials/footer.html",
            "left-sidebar": "/templates/partials/left-sidebar.html",
            "righsidebar": "/templates/partials/right-sidebar.html",
            "vendorjs": "/templates/partials/vendorjs.html"
        };
        loadLayoutComponents(components);
    </script>
    <script src="/static/js/employees/list-handler.js"></script>
    <script src="/static/js/employees/payment-handler.js"></script>
    
    
</body>

</html>